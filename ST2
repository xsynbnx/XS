import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBzaWduYWwKaW1wb3J0IHRpbWUKZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCgojIOminOiJsuWumuS5iQpjbGFzcyBDb2xvcnM6CiAgICBSRVNFVCA9ICJcMDMzWzBtIgogICAgUkVEID0gIlwwMzNbMzFtIgogICAgR1JFRU4gPSAiXDAzM1szMm0iCiAgICBZRUxMT1cgPSAiXDAzM1szM20iCiAgICBCTFVFID0gIlwwMzNbMzRtIgogICAgQ1lBTiA9ICJcMDMzWzM2bSIKICAgIEJPTEQgPSAiXDAzM1sxbSIKICAgIFBVUlBMRSA9ICJcMDMzWzM1bSIKCmNsYXNzIE11c2ljUGxheWVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuY3VycmVudF9zb25nID0gIiIKICAgICAgICBzZWxmLm1wdl9wcm9jZXNzID0gTm9uZQogICAgICAgIHNlbGYuY3VycmVudF9pbmRleCA9IC0xCiAgICAgICAgCiAgICAgICAgIyDpn7PkuZDlupPphY3nva4KICAgICAgICBzZWxmLm11c2ljX2RpciA9IHN0cihQYXRoKF9fZmlsZV9fKS5wYXJlbnQgLyAiTXVzaWMiKQogICAgICAgIHNlbGYuc29uZ19saXN0ID0gWwogICAgICAgICAgICAoIum4oeWPqy5tcDMiLCAiMS4g6bih5p+z54mI5piO5piO5bCxIiksCiAgICAgICAgICAgICgi5aSp55yf55qE5qmh55quREoubXAzIiwgIjIuIOWkqeecn+eahOapoeeariIpLAogICAgICAgICAgICAoIuWuieWSjOahpS5tcDMiLCAiMy4g5a6J5ZKM5qGlIiksCiAgICAgICAgICAgICgi5oKs5rq6Lm1wMyIsICI0LiDmgqzmuroiKSwKICAgICAgICAgICAgKCLlhavmlrnmnaXotKJESi5tcDMiLCAiNS4g5YWr5pa55p2l6LSiIiksCiAgICAgICAgICAgICgi572X55Sf6ZeoLm1wMyIsICI2LiDnvZfnlJ/pl6giKSwKICAgICAgICAgICAgKCLlsI/lrakubXAzIiwgIjcuIOWwj+WtqSIpLAogICAgICAgICAgICAoIjQubXAzIiwgIjguIOaIkeeahOWlveWFhOW8nyIpLAogICAgICAgICAgICAoIuesrDU35qyh5Y+W5raI5Y+R6YCBLm1wMyIsICI5LiDnrKw1N+asoeWPlua2iOWPkemAgSIpLAogICAgICAgICAgICAoIumHjuS6ui5tcDMiLCAiMTAuIOmHjuS6uiIpLAogICAgICAgICAgICAoIum4oeafszEubXAzIiwgIjExLiDpuKHmn7PniYjnrKw1N+asoeWPlua2iOWPkemAgSIpLAogICAgICAgICAgICAoIuWkqeS4iy5tcDMiLCAiMTIuIOWkqeS4iyIpLAogICAgICAgICAgICAoIuS4i+S4gOS4quWkqeS6ri5tcDMiLCAiMTMuIOS4i+S4gOS4quWkqeS6riIpLAogICAgICAgICAgICAoIueItuS6si5tcDMiLCAiMTQuIOeItuS6siIpLAogICAgICAgICAgICAoIuacgOWQjuS4gOmmluatjC5tcDMiLCAiMTUuIOacgOWQjuS4gOmmluatjCIpICAjIOa3u+WKoOesrDE16aaW5q2MCiAgICAgICAgXQoKICAgIGRlZiBjaGVja19tcHYoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdWJwcm9jZXNzLnJ1bihbIm1wdiIsICItLXZlcnNpb24iXSwgY2hlY2s9VHJ1ZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0NvbG9ycy5ZRUxMT1d95qOA5rWL5Yiw57O757uf5pyq5a6J6KOFbXB25pKt5pS+5Zmoe0NvbG9ycy5SRVNFVH0iKQogICAgICAgICAgICBpbnN0YWxsX2Nob2ljZSA9IGlucHV0KCLmmK/lkKboh6rliqjlronoo4U/IFtZL25dICIpLnN0cmlwKCkubG93ZXIoKQogICAgICAgICAgICBpZiBpbnN0YWxsX2Nob2ljZSAhPSAnbic6CiAgICAgICAgICAgICAgICBwcmludChmIntDb2xvcnMuQkxVRX3mraPlnKjlronoo4VtcHYuLi57Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoIi9ldGMvZGViaWFuX3ZlcnNpb24iKToKICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJzdWRvIiwgImFwdCIsICJ1cGRhdGUiXSwgY2hlY2s9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJzdWRvIiwgImFwdCIsICJpbnN0YWxsIiwgIi15IiwgIm1wdiJdLCBjaGVjaz1UcnVlKQogICAgICAgICAgICAgICAgICAgIGVsaWYgb3MucGF0aC5leGlzdHMoIi9ldGMvcmVkaGF0LXJlbGVhc2UiKToKICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJzdWRvIiwgImRuZiIsICJpbnN0YWxsIiwgIi15IiwgIm1wdiJdLCBjaGVjaz1UcnVlKQogICAgICAgICAgICAgICAgICAgIGVsaWYgb3MucGF0aC5leGlzdHMoIi91c3IvbG9jYWwvYmluL2JyZXciKToKICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJicmV3IiwgImluc3RhbGwiLCAibXB2Il0sIGNoZWNrPVRydWUpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLlJFRH3ml6Dms5Xoh6rliqjlronoo4XvvIzor7fmiYvliqjlronoo4VtcHZ7Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMg6aqM6K+B5a6J6KOFCiAgICAgICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJtcHYiLCAiLS12ZXJzaW9uIl0sIGNoZWNrPVRydWUpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLkdSRUVOfW1wduWuieijheaIkOWKn++8gXtDb2xvcnMuUkVTRVR9IikKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBwcmludChmIntDb2xvcnMuUkVEfW1wduWuieijheWksei0pe+8jOivt+aJi+WKqOWuieijheWQjumHjeivlXtDb2xvcnMuUkVTRVR9IikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KGYie0NvbG9ycy5SRUR95b+F6aG75a6J6KOFbXB25omN6IO95L2/55So5pys5pKt5pS+5Zmoe0NvbG9ycy5SRVNFVH0iKQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIHBsYXlfc29uZyhzZWxmLCBpbmRleCk6CiAgICAgICAgaWYgaW5kZXggPCAwIG9yIGluZGV4ID49IGxlbihzZWxmLnNvbmdfbGlzdCk6CiAgICAgICAgICAgIHByaW50KGYie0NvbG9ycy5SRUR96ZSZ6K+vOiDml6DmlYjnmoTmrYzmm7LntKLlvJV7Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIAogICAgICAgIHNvbmdfZmlsZSwgc29uZ19uYW1lID0gc2VsZi5zb25nX2xpc3RbaW5kZXhdCiAgICAgICAgZnVsbF9wYXRoID0gc3RyKFBhdGgoc2VsZi5tdXNpY19kaXIpIC8gc29uZ19maWxlKQogICAgICAgIAogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmdWxsX3BhdGgpOgogICAgICAgICAgICBwcmludChmIntDb2xvcnMuUkVEfemUmeivrzog5om+5LiN5Yiw5paH5Lu2IHtmdWxsX3BhdGh9e0NvbG9ycy5SRVNFVH0iKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAKICAgICAgICAjIOWmguaenOW3sue7j+WcqOaSreaUvui/memmluatjO+8jOS4jemHjeWkjeaSreaUvgogICAgICAgIGlmIGluZGV4ID09IHNlbGYuY3VycmVudF9pbmRleCBhbmQgc2VsZi5tcHZfcHJvY2VzcyBhbmQgc2VsZi5tcHZfcHJvY2Vzcy5wb2xsKCkgaXMgTm9uZToKICAgICAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLllFTExPV33lt7LlnKjmkq3mlL46IHtDb2xvcnMuQ1lBTn17c29uZ19uYW1lfXtDb2xvcnMuUkVTRVR9IikKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAKICAgICAgICBzZWxmLnN0b3Bfc29uZygpCiAgICAgICAgCiAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLkdSRUVOfeato+WcqOaSreaUvjoge0NvbG9ycy5DWUFOfXtzb25nX25hbWV9e0NvbG9ycy5SRVNFVH0iKQogICAgICAgIHNlbGYuY3VycmVudF9zb25nID0gc29uZ19uYW1lCiAgICAgICAgc2VsZi5jdXJyZW50X2luZGV4ID0gaW5kZXgKICAgICAgICAKICAgICAgICAjIOS9v+eUqG5vaHVw5ZKMbXB255qELS1sb29w6YCJ6aG5CiAgICAgICAgc2VsZi5tcHZfcHJvY2VzcyA9IHN1YnByb2Nlc3MuUG9wZW4oCiAgICAgICAgICAgIFsibXB2IiwgIi0tbm8tdmlkZW8iLCAiLS1sb29wIiwgIi0tcmVhbGx5LXF1aWV0IiwgZnVsbF9wYXRoXSwKICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuREVWTlVMTCwKICAgICAgICAgICAgc3RkZXJyPXN1YnByb2Nlc3MuREVWTlVMTCwKICAgICAgICAgICAgcHJlZXhlY19mbj1vcy5zZXRwZ3JwCiAgICAgICAgKQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIHN0b3Bfc29uZyhzZWxmKToKICAgICAgICBpZiBzZWxmLm1wdl9wcm9jZXNzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBvcy5raWxscGcob3MuZ2V0cGdpZChzZWxmLm1wdl9wcm9jZXNzLnBpZCksIHNpZ25hbC5TSUdURVJNKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIHNlbGYubXB2X3Byb2Nlc3MgPSBOb25lCiAgICAgICAgCiAgICAgICAgc2VsZi5jdXJyZW50X3NvbmcgPSAiIgogICAgICAgIHNlbGYuY3VycmVudF9pbmRleCA9IC0xCiAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLlJFRH3lt7LlgZzmraLmkq3mlL57Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgCiAgICAgICAgIyDnoa7kv53msqHmnInmrovnlZnnmoRtcHbov5vnqIsKICAgICAgICBzdWJwcm9jZXNzLnJ1bihbInBraWxsIiwgIi1mIiwgIm1wdiAtLW5vLXZpZGVvIC0tbG9vcCAtLXJlYWxseS1xdWlldCJdLCAKICAgICAgICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLkRFVk5VTEwsIHN0ZGVycj1zdWJwcm9jZXNzLkRFVk5VTEwpCgogICAgZGVmIHNob3dfbWVudShzZWxmKToKICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJyBpZiBvcy5uYW1lID09ICdwb3NpeCcgZWxzZSAnY2xzJykKICAgICAgICBwcmludChmIntDb2xvcnMuUFVSUExFfXtDb2xvcnMuQk9MRH3wn461IOWwj+mFpee/vEtEViDwn461e0NvbG9ycy5SRVNFVH0iKQogICAgICAgIHByaW50KGYie0NvbG9ycy5CTFVFfV9fX19fX19fX19fX19fX19fX19fX19fX19fe0NvbG9ycy5SRVNFVH0iKQogICAgICAgIAogICAgICAgIGZvciBpLCAoXywgbmFtZSkgaW4gZW51bWVyYXRlKHNlbGYuc29uZ19saXN0KToKICAgICAgICAgICAgcHJpbnQoZiIge0NvbG9ycy5HUkVFTn17bmFtZX17Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgCiAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLkJMVUV9LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0te0NvbG9ycy5SRVNFVH0iKQogICAgICAgIHByaW50KGYiIHtDb2xvcnMuWUVMTE9XfTE2LiDpgIDlh7rnqIvluo97Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgcHJpbnQoZiIge0NvbG9ycy5SRUR9cy4g5YGc5q2i5pKt5pS+e0NvbG9ycy5SRVNFVH0iKQogICAgICAgIHByaW50KGYie0NvbG9ycy5CTFVFfS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXtDb2xvcnMuUkVTRVR9IikKICAgICAgICAKICAgICAgICAjIOaSreaUvueKtuaAgQogICAgICAgIGlmIHNlbGYubXB2X3Byb2Nlc3MgYW5kIHNlbGYubXB2X3Byb2Nlc3MucG9sbCgpIGlzIE5vbmU6CiAgICAgICAgICAgIHByaW50KGYie0NvbG9ycy5ZRUxMT1d94pa2IOW9k+WJjeaSreaUvjoge0NvbG9ycy5DWUFOfXtzZWxmLmN1cnJlbnRfc29uZ317Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgICAgIHByaW50KGYie0NvbG9ycy5CTFVFfeaPkOekujror7fkuI3opoHph43lpI3ngrnlh7vlkIzkuIDpppbpn7PkuZB7Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLllFTExPV33ij7kg5b2T5YmN5rKh5pyJ5pKt5pS+6Z+z5LmQe0NvbG9ycy5SRVNFVH0iKQogICAgICAgIAogICAgICAgIHJldHVybiBpbnB1dCgiXG7or7fovpPlhaXpgInmi6nnvJblj7c6ICIpLnN0cmlwKCkKCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLmNoZWNrX21wdigpOgogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBjaG9pY2UgPSBzZWxmLnNob3dfbWVudSgpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBjaG9pY2UuaXNkaWdpdCgpOgogICAgICAgICAgICAgICAgaW5kZXggPSBpbnQoY2hvaWNlKSAtIDEKICAgICAgICAgICAgICAgIGlmIDAgPD0gaW5kZXggPCBsZW4oc2VsZi5zb25nX2xpc3QpOgogICAgICAgICAgICAgICAgICAgIHNlbGYucGxheV9zb25nKGluZGV4KQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICAgICAgIGVsaWYgaW5kZXggPT0gMTU6ICAjIOmAgOWHuumAiemhuQogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYubXB2X3Byb2Nlc3MgYW5kIHNlbGYubXB2X3Byb2Nlc3MucG9sbCgpIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie0NvbG9ycy5HUkVFTn3pgIDlh7rohJrmnKzvvIF7Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie0NvbG9ycy5CTFVFfemfs+S5kOWwhue7p+e7reaSreaUvu+8jOS9v+eUqCAncGtpbGwgbXB2JyDlj6/lvbvlupXlgZzmraJ7Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLkdSRUVOfeaEn+iwouS9v+eUqO+8jOWGjeinge+8gXtDb2xvcnMuUkVTRVR9IikKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJ7Q29sb3JzLlJFRH3ml6DmlYjnmoTnvJblj7fvvIzor7fph43mlrDovpPlhaV7Q29sb3JzLlJFU0VUfSIpCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgICAgICBlbGlmIGNob2ljZS5sb3dlcigpID09ICdzJzoKICAgICAgICAgICAgICAgIHNlbGYuc3RvcF9zb25nKCkKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KGYie0NvbG9ycy5SRUR95peg5pWI6L6T5YWl77yM6K+36YeN5paw6YCJ5oupe0NvbG9ycy5SRVNFVH0iKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIHBsYXllciA9IE11c2ljUGxheWVyKCkKICAgIHBsYXllci5ydW4oKQ==').decode('utf-8'))