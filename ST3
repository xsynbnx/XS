import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uCmltcG9ydCBzeXMKaW1wb3J0IHJlCmltcG9ydCBvcwppbXBvcnQgaW1wb3J0bGliLnV0aWwKaW1wb3J0IGhhc2hsaWIKaW1wb3J0IHNodXRpbAoKIyBBTlNJ6L2s5LmJ5bqP5YiX5a6a5LmJ6aKc6ImyClJFRCA9ICdcMDMzWzkxbScKR1JFRU4gPSAnXDAzM1s5Mm0nCllFTExPVyA9ICdcMDMzWzkzbScKQkxVRSA9ICdcMDMzWzk0bScKQ1lBTiA9ICdcMDMzWzk2bScKRU5EQyA9ICdcMDMzWzBtJwoKCmRlZiBsb2FkX3B5X2NvbmZpZyhjb25maWdfcGF0aCk6CiAgICB0cnk6CiAgICAgICAgc3BlYyA9IGltcG9ydGxpYi51dGlsLnNwZWNfZnJvbV9maWxlX2xvY2F0aW9uKCJjb25maWdfbW9kdWxlIiwgY29uZmlnX3BhdGgpCiAgICAgICAgY29uZmlnX21vZHVsZSA9IGltcG9ydGxpYi51dGlsLm1vZHVsZV9mcm9tX3NwZWMoc3BlYykKICAgICAgICBzcGVjLmxvYWRlci5leGVjX21vZHVsZShjb25maWdfbW9kdWxlKQogICAgICAgIHJldHVybiBjb25maWdfbW9kdWxlCiAgICBleGNlcHQgRmlsZU5vdEZvdW5kRXJyb3I6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIntSRUR96ZSZ6K+vOuWvvOWFpVB56YWN572u5paH5Lu25pe25Ye66ZSZOiB7ZX17RU5EQ30iKQogICAgICAgIHN5cy5leGl0KDEpCgoKZGVmIGRlY2ltYWxfdG9faGV4X2xpdHRsZV9lbmRpYW4obnVtYmVyKToKICAgIGhleF9zdHIgPSBudW1iZXIudG9fYnl0ZXMoNCwgYnl0ZW9yZGVyPSdsaXR0bGUnKS5oZXgoKQogICAgcmV0dXJuIGhleF9zdHIKCgpkZWYgc3dhcF9oZXhfYnl0ZXMoY29udGVudCwgaGV4MSwgaGV4Mik6CiAgICBieXRlczEgPSBieXRlcy5mcm9taGV4KGhleDEpCiAgICBieXRlczIgPSBieXRlcy5mcm9taGV4KGhleDIpCgogICAgaW5kaWNlczEgPSBbbS5zdGFydCgpIGZvciBtIGluIHJlLmZpbmRpdGVyKHJlLmVzY2FwZShieXRlczEpLCBjb250ZW50KV0KICAgIGluZGljZXMyID0gW20uc3RhcnQoKSBmb3IgbSBpbiByZS5maW5kaXRlcihyZS5lc2NhcGUoYnl0ZXMyKSwgY29udGVudCldCgogICAgaWYgbGVuKGluZGljZXMxKSA9PSAwIG9yIGxlbihpbmRpY2VzMikgPT0gMDoKICAgICAgICByZXR1cm4gY29udGVudCwgRmFsc2UKCiAgICBzd2FwX2NvdW50ID0gbWluKGxlbihpbmRpY2VzMSksIGxlbihpbmRpY2VzMikpCgogICAgbmV3X2NvbnRlbnQgPSBieXRlYXJyYXkoY29udGVudCkKCiAgICBmb3IgaSBpbiByYW5nZShzd2FwX2NvdW50KToKICAgICAgICBpbmRleDEgPSBpbmRpY2VzMVtpXQogICAgICAgIGluZGV4MiA9IGluZGljZXMyW2ldCgogICAgICAgIGxlbjEgPSBsZW4oYnl0ZXMxKQogICAgICAgIGxlbjIgPSBsZW4oYnl0ZXMyKQoKICAgICAgICBpZiBsZW4xICE9IGxlbjI6CiAgICAgICAgICAgIHByaW50KGYie1JFRH3plJnor686IOWNgeWFrei/m+WItuWAvCAne2hleDF9JyDlkowgJ3toZXgyfScg55qE5a2X6IqC6ZW/5bqm5LiN5ZCM77yM5peg5rOV5LqS5o2i44CCe0VOREN9IikKICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQsIEZhbHNlCgogICAgICAgIG5ld19jb250ZW50W2luZGV4MTppbmRleDEgKyBsZW4xXSA9IGJ5dGVzMgogICAgICAgIG5ld19jb250ZW50W2luZGV4MjppbmRleDIgKyBsZW4yXSA9IGJ5dGVzMQoKICAgIHJldHVybiBuZXdfY29udGVudCwgVHJ1ZQoKCmRlZiBjYWxjdWxhdGVfZmlsZV9oYXNoKGZpbGVfcGF0aCk6CiAgICBoYXNoX29iamVjdCA9IGhhc2hsaWIubWQ1KCkKICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICdyYicpIGFzIGZpbGU6CiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgZGF0YSA9IGZpbGUucmVhZCg2NTUzNikKICAgICAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBoYXNoX29iamVjdC51cGRhdGUoZGF0YSkKICAgIHJldHVybiBoYXNoX29iamVjdC5oZXhkaWdlc3QoKQoKCmRlZiBmaW5kX21hdGNoaW5nX2RhdF9maWxlcyhzZWFyY2hfcGF0aCwga2V5d29yZCk6CiAgICBtYXRjaGluZ19maWxlcyA9IFtdCiAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhzZWFyY2hfcGF0aCk6CiAgICAgICAgZm9yIGZpbGUgaW4gZmlsZXM6CiAgICAgICAgICAgIGlmIGZpbGUuZW5kc3dpdGgoJy5kYXQnKSBhbmQga2V5d29yZC5sb3dlcigpIGluIGZpbGUubG93ZXIoKToKICAgICAgICAgICAgICAgIG1hdGNoaW5nX2ZpbGVzLmFwcGVuZChvcy5wYXRoLmpvaW4ocm9vdCwgZmlsZSkpCiAgICByZXR1cm4gbWF0Y2hpbmdfZmlsZXMKCgpkZWYgbWFpbigpOgogICAgcHJpbnQoZiJ7Q1lBTn3lhazlkYp7RU5EQ30iKQogICAgcHJpbnQoZiJ7Q1lBTn0qKuWIsOesrOS6jOatpeafpeaJvmRhdOWQjeWtl+WKoOe+pOiOt+W+l+WQjeensHtFTkRDfSIpCiAgICBwcmludChmIntSRUR95LiA5a6a6KaB5Yqg5YWl576k6IGK5omN55+l6YGTZGF055qE5ZCN56ew5Li76aG15pyJ576k6IGK5ZOme0VOREN9IikKICAgICMgMS4g6I635Y+W6YWN572u5paH5Lu26Lev5b6ECiAgICBjb25maWdfcGF0aCA9IGlucHV0KCLor7fovpPlhaXphY3nva7mlofku7bnmoTlrozmlbTot6/lvoQ6ICIpLnN0cmlwKCkKICAgIHdoaWxlIG5vdCBvcy5wYXRoLmlzZmlsZShjb25maWdfcGF0aCk6CiAgICAgICAgcHJpbnQoZiJ7UkVEfemUmeivrzrmlofku7bkuI3lrZjlnKjvvIzor7fph43mlrDovpPlhaV7RU5EQ30iKQogICAgICAgIGNvbmZpZ19wYXRoID0gaW5wdXQoIuivt+i+k+WFpemFjee9ruaWh+S7tueahOWujOaVtOi3r+W+hDogIikuc3RyaXAoKQoKICAgICMgMi4g5Yqg6L296YWN572u5paH5Lu2CiAgICBjb25maWcgPSBsb2FkX3B5X2NvbmZpZyhjb25maWdfcGF0aCkKICAgIGlmIGNvbmZpZyBpcyBOb25lOgogICAgICAgIHByaW50KGYie1JFRH3plJnor6865peg5rOV5Yqg6L296YWN572u5paH5Lu2e0VOREN9IikKICAgICAgICBzeXMuZXhpdCgxKQoKICAgIOmFjee9riA9IGNvbmZpZy7phY3nva4KICAgIGlmIG5vdCDphY3nva46CiAgICAgICAgcHJpbnQoZiJ7UkVEfemUmeivrzog6YWN572u5paH5Lu25Lit5rKh5pyJ5a6a5LmJ5Lu75L2V5Y2B6L+b5Yi25pWw5a+5e0VOREN9IikKICAgICAgICBzeXMuZXhpdCgxKQoKICAgICMgMy4g6K6+572u5pCc57Si6Lev5b6E5ZKM6L6T5Ye66Lev5b6ECiAgICBzZWFyY2hfcGF0aCA9ICIvc3RvcmFnZS9lbXVsYXRlZC8wL+WFqOiHquWKqOe+juWMli/op6PljIVkYXQvIgogICAgb3V0cHV0X3BhdGggPSAiL3N0b3JhZ2UvZW11bGF0ZWQvMC/lhajoh6rliqjnvo7ljJYv5omT5YyFZGF0LyIKICAgIAogICAgIyDliJvlu7rovpPlh7rnm67lvZXlpoLmnpzkuI3lrZjlnKgKICAgIG9zLm1ha2VkaXJzKG91dHB1dF9wYXRoLCBleGlzdF9vaz1UcnVlKQogICAgCiAgICAjIDQuIOiOt+WPluimgeafpeaJvueahOaWh+S7tuWQjeWFs+mUruWtlwogICAga2V5d29yZCA9IGlucHV0KCLor7fovpPlhaXopoHmn6Xmib7nmoQuZGF05paH5Lu25ZCN5YWz6ZSu5a2XOiAiKS5zdHJpcCgpCiAgICBtYXRjaGluZ19maWxlcyA9IGZpbmRfbWF0Y2hpbmdfZGF0X2ZpbGVzKHNlYXJjaF9wYXRoLCBrZXl3b3JkKQogICAgCiAgICBpZiBub3QgbWF0Y2hpbmdfZmlsZXM6CiAgICAgICAgcHJpbnQoZiJ7UkVEfemUmeivrzog5Zyo6Lev5b6EICd7c2VhcmNoX3BhdGh9JyDkuK3mnKrmib7liLDljIXlkKsgJ3trZXl3b3JkfScg55qELmRhdOaWh+S7tntFTkRDfSIpCiAgICAgICAgc3lzLmV4aXQoMSkKICAgIAogICAgIyA1LiDmmL7npLrljLnphY3nmoTmlofku7borqnnlKjmiLfpgInmi6kKICAgIHByaW50KGYiXG57WUVMTE9XfeaJvuWIsOS7peS4i+WMuemFjeeahOaWh+S7tjp7RU5EQ30iKQogICAgZm9yIGksIGZpbGVfcGF0aCBpbiBlbnVtZXJhdGUobWF0Y2hpbmdfZmlsZXMsIDEpOgogICAgICAgIHByaW50KGYie2l9LiB7b3MucGF0aC5iYXNlbmFtZShmaWxlX3BhdGgpfSAo6Lev5b6EOiB7b3MucGF0aC5kaXJuYW1lKGZpbGVfcGF0aCl9KSIpCgogICAgIyA2LiDojrflj5bnlKjmiLfpgInmi6nnmoTmlofku7YKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjaG9pY2UgPSBpbnB1dCgiXG7or7fpgInmi6nopoHkv67mlLnnmoTmlofku7bnvJblj7fmiJbovpPlhaVz6YCA5Ye6OiAiKS5zdHJpcCgpCiAgICAgICAgICAgIGlmIGNob2ljZS5sb3dlcigpID09ICdzJzoKICAgICAgICAgICAgICAgIHByaW50KGYie1lFTExPV33lt7Llj5bmtojmk43kvZx7RU5EQ30iKQogICAgICAgICAgICAgICAgc3lzLmV4aXQoMCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBjaG9pY2UgPSBpbnQoY2hvaWNlKQogICAgICAgICAgICBpZiAxIDw9IGNob2ljZSA8PSBsZW4obWF0Y2hpbmdfZmlsZXMpOgogICAgICAgICAgICAgICAgZGF0X2ZpbGVfcGF0aCA9IG1hdGNoaW5nX2ZpbGVzW2Nob2ljZSAtIDFdCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7UkVEfemUmeivrzog6K+36L6T5YWlMS17bGVuKG1hdGNoaW5nX2ZpbGVzKX3kuYvpl7TnmoTmlbDlrZd7RU5EQ30iKQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICBwcmludChmIntSRUR96ZSZ6K+vOiDor7fovpPlhaXmnInmlYjnmoTmlbDlrZfmiJZz6YCA5Ye6e0VOREN9IikKCiAgICAjIDcuIOiusOW9leS/ruaUuee7k+aenAogICAgc3VjY2Vzc19wYWlycyA9IFtdCiAgICBmYWlsZWRfcGFpcnMgPSBbXQoKICAgIHRyeToKICAgICAgICAjIOiuoeeul+S/ruaUueWJjeeahOWTiOW4jOWAvAogICAgICAgIGhhc2hfYmVmb3JlID0gY2FsY3VsYXRlX2ZpbGVfaGFzaChkYXRfZmlsZV9wYXRoKQoKICAgICAgICB3aXRoIG9wZW4oZGF0X2ZpbGVfcGF0aCwgJ3JiJykgYXMgZmlsZToKICAgICAgICAgICAgY29udGVudCA9IGZpbGUucmVhZCgpCgogICAgICAgIHRvdGFsX3BhaXJzID0gbGVuKOmFjee9rikKCiAgICAgICAgcHJpbnQoZiJcbntHUkVFTn3lvIDlp4vlpITnkIbmlofku7Y6IHtvcy5wYXRoLmJhc2VuYW1lKGRhdF9maWxlX3BhdGgpfXtFTkRDfSIpCiAgICAgICAgcHJpbnQoZiJ7Q1lBTn3lhbHpnIDopoHlpITnkIYge3RvdGFsX3BhaXJzfSDlr7nphY3nva57RU5EQ30iKQoKICAgICAgICBmb3IgaW5kZXgsIChkZWMxLCBkZWMyKSBpbiBlbnVtZXJhdGUo6YWN572uLCBzdGFydD0xKToKICAgICAgICAgICAgaGV4MSA9IGRlY2ltYWxfdG9faGV4X2xpdHRsZV9lbmRpYW4oZGVjMSkKICAgICAgICAgICAgaGV4MiA9IGRlY2ltYWxfdG9faGV4X2xpdHRsZV9lbmRpYW4oZGVjMikKCiAgICAgICAgICAgIHByaW50KGYiXG57WUVMTE9Xfeato+WcqOWkhOeQhuesrCB7aW5kZXh9L3t0b3RhbF9wYWlyc30g5a+55pWw5YC8e0VOREN9IikKICAgICAgICAgICAgcHJpbnQoZiLmqKHlvI8xOiB7QkxVRX17aGV4MX17RU5EQ30g4oaSIOabv+aNouS4uiB7QkxVRX17aGV4Mn17RU5EQ30iKQogICAgICAgICAgICBwcmludChmIuaooeW8jzI6IHtCTFVFfXtoZXgyfXtFTkRDfSDihpIg5pu/5o2i5Li6IHtCTFVFfXtoZXgxfXtFTkRDfSIpCgogICAgICAgICAgICBieXRlczEgPSBieXRlcy5mcm9taGV4KGhleDEpCiAgICAgICAgICAgIGJ5dGVzMiA9IGJ5dGVzLmZyb21oZXgoaGV4MikKICAgICAgICAgICAgaW5kaWNlczEgPSBbbS5zdGFydCgpIGZvciBtIGluIHJlLmZpbmRpdGVyKHJlLmVzY2FwZShieXRlczEpLCBjb250ZW50KV0KICAgICAgICAgICAgaW5kaWNlczIgPSBbbS5zdGFydCgpIGZvciBtIGluIHJlLmZpbmRpdGVyKHJlLmVzY2FwZShieXRlczIpLCBjb250ZW50KV0KCiAgICAgICAgICAgIHByaW50KGYi5om+5Yiw5qih5byPMeeahOS9jee9rjoge1lFTExPV317aW5kaWNlczF9e0VOREN9IikKICAgICAgICAgICAgcHJpbnQoZiLmib7liLDmqKHlvI8y55qE5L2N572uOiB7WUVMTE9XfXtpbmRpY2VzMn17RU5EQ30iKQoKICAgICAgICAgICAgY29udGVudCwgc3dhcHBlZCA9IHN3YXBfaGV4X2J5dGVzKGNvbnRlbnQsIGhleDEsIGhleDIpCiAgICAgICAgICAgIGlmIHN3YXBwZWQ6CiAgICAgICAgICAgICAgICBzd2FwX2NvdW50ID0gbWluKGxlbihpbmRpY2VzMSksIGxlbihpbmRpY2VzMikpCiAgICAgICAgICAgICAgICBwcmludChmIntHUkVFTn3miJDlip/kuqTmjaIge3N3YXBfY291bnR9IOWkhHtFTkRDfSIpCiAgICAgICAgICAgICAgICBzdWNjZXNzX3BhaXJzLmFwcGVuZCgoZGVjMSwgZGVjMikpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludChmIntSRUR95Lqk5o2i5aSx6LSle0VOREN9IikKICAgICAgICAgICAgICAgIGZhaWxlZF9wYWlycy5hcHBlbmQoKGRlYzEsIGRlYzIpKQoKICAgICAgICAjIOaehOW7uui+k+WHuuaWh+S7tui3r+W+hAogICAgICAgIG91dHB1dF9maWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ob3V0cHV0X3BhdGgsIG9zLnBhdGguYmFzZW5hbWUoZGF0X2ZpbGVfcGF0aCkpCiAgICAgICAgCiAgICAgICAgIyDlhpnlhaXkv67mlLnlkI7nmoTlhoXlrrnliLDovpPlh7rot6/lvoQKICAgICAgICB3aXRoIG9wZW4ob3V0cHV0X2ZpbGVfcGF0aCwgJ3diJykgYXMgZmlsZToKICAgICAgICAgICAgZmlsZS53cml0ZShjb250ZW50KQoKICAgICAgICAjIOiuoeeul+S/ruaUueWQjueahOWTiOW4jOWAvAogICAgICAgIGhhc2hfYWZ0ZXIgPSBjYWxjdWxhdGVfZmlsZV9oYXNoKG91dHB1dF9maWxlX3BhdGgpCgogICAgICAgICMg5pi+56S657uT5p6c5pGY6KaBCiAgICAgICAgcHJpbnQoZiJcbntDWUFOfV9fX19fX+WkhOeQhue7k+aenF9fX19fX19fe0VOREN9IikKICAgICAgICBwcmludChmIntHUkVFTn3miJDlip/kv67mlLnmlofku7Y6IHtvcy5wYXRoLmJhc2VuYW1lKGRhdF9maWxlX3BhdGgpfXtFTkRDfSIpCiAgICAgICAgcHJpbnQoZiLljp/lp4vmlofku7bot6/lvoQ6IHtkYXRfZmlsZV9wYXRofSIpCiAgICAgICAgcHJpbnQoZiLkv67mlLnlkI7mlofku7bkv53lrZjliLA6IHtvdXRwdXRfZmlsZV9wYXRofSIpCiAgICAgICAgcHJpbnQoZiLliY1NRDU6IHtoYXNoX2JlZm9yZX0iKQogICAgICAgIHByaW50KGYi5ZCOTUQ1OiB7aGFzaF9hZnRlcn0iKQogICAgICAgIHByaW50KGYiXG57R1JFRU595oiQ5Yqf5aSE55CGIHtsZW4oc3VjY2Vzc19wYWlycyl9L3t0b3RhbF9wYWlyc30g5a+56YWN572ue0VOREN9IikKICAgICAgICAKICAgICAgICBpZiBmYWlsZWRfcGFpcnM6CiAgICAgICAgICAgIHByaW50KGYie1JFRH3ku6XkuIvphY3nva7lr7nlpITnkIblpLHotKU6IHtmYWlsZWRfcGFpcnN9e0VOREN9IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChmIntHUkVFTn3miYDmnInphY3nva7lr7npg73lpITnkIbmiJDlip8he0VOREN9IikKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJ7UkVEfeWkhOeQhuaWh+S7tuaXtuWPkeeUn+mUmeivrzoge2V9e0VOREN9IikKICAgICAgICBzeXMuZXhpdCgxKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCkKCg==').decode('utf-8'))